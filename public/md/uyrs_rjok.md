# 工程文档

## json文件

```json
{
    "品牌标识":"BYDEV",
    "默认协议": [
        {
            "协议类型": "CANBUS11",
            "波特率": 500,
            "引脚": [
                6,
                14
            ],
            "会话模式": "02 10 01",
            "link": "02 3e 80"
        },
        {
            "协议类型": "CANBUS11",
            "波特率": 500,
            "引脚": [
                3,
                11
            ],
            "会话模式": "02 10 01",
            "link": "02 3e 80"
        }
    ],
    "默认数据流文件夹": "数据流",
    "默认版本信息文件夹": "版本信息",
    "默认读码文件夹": "读.*码",
    "默认清码文件夹": "清.*码"
}
```

json文件用于描述工程以及资料。是不可或缺的配置文件。


### 专用属性

#### 品牌标识
```json
{
    "品牌标识":"BYDEV"
}
```
**品牌标识** 指定了该工程的加密资料在`云电动力`的`Vehicle`目录下的存放位置。该属性一般用于project.json配置。一个工程需要唯一个project.json来配置该工程的基本信息。当然，你可以直接使用初始化指令`proj=init`来新建一个初始的project.json。

### 公用属性

公用属性可用于配置project.json或config.json。

#### 默认协议
```json
{
    "默认协议": [
        {
            "协议类型": "CANBUS11",
            "波特率": 500,
            "引脚": [
                6,
                14
            ],
            "会话模式": "02 10 01",
            "link": "02 3e 80"
        },
        {
            "协议类型": "CANBUS11",
            "波特率": 500,
            "引脚": [
                3,
                11
            ],
            "会话模式": "02 10 01",
            "link": "02 3e 80"
        }
    ]
}

```
该属性指定当前文件夹以及子文件夹所使用的通讯协议。子文件夹可以修改该属性，方法是，在它的目录下的config.json里指定`当前协议`，这样，程序就能将`当前协议`支配给`默认协议`的所有子对象。

子文件夹也可以重新指定`默认协议`，彻底地修改当前文件夹和子文件夹的通讯协议，所使用的方法同样是在它的config.json里面直接指定`默认协议`。以下是`默认协议`示例。

##### CANBUS-J1939协议


```json
{
    "默认协议": [
        {
            "协议类型": "CANBUS-J1939",
            "波特率": 500,
            "引脚": [
                3,
                11
            ],
            "广播ID":"0x45c"
        }
    ]
}

```
J1939协议基于CANBUS系统，使用该协议的ECU是自发式、广播式地向公共回路发送数据。无需请求应答。

广播ID只需填一个ID就行，不能填多个ID. 该属性仅作为检测通讯是否成功的依据。

##### CANBUS11协议
```json
{
    "默认协议": [
        {
            "协议类型": "CANBUS11",
            "波特率": 500,
            "引脚": [
                3,
                11
            ],
            "会话模式": "02 10 01",
            "link": "02 3e 80"
        }
    ]
}

```

##### CANBUS29协议
```json
{
    "默认协议": [
        {
            "协议类型": "CANBUS29",
            "波特率": 500,
            "引脚": [
                3,
                11
            ],
            "会话模式": "02 10 01",
            "link": "02 3e 80"
        }
    ]
}

```

#### 当前协议
```json
{
    "当前协议":{
        "请求ID":"fc00",
        "应答ID":"fd00"
    }
}

```

若文件夹指定了`当前协议`，程序会将`当前协议`的所有子属性赋予`默认协议`的所有子对象。效果如下：

```json
{
    "默认协议": [
        {
            "协议类型": "CANBUS11",
            "波特率": 500,
            "引脚": [
                6,
                14
            ],
            "会话模式": "02 10 01",
            "link": "02 3e 80",
            "请求ID":"fc00",
            "应答ID":"fd00"
        },
        {
            "协议类型": "CANBUS11",
            "波特率": 500,
            "引脚": [
                3,
                11
            ],
            "会话模式": "02 10 01",
            "link": "02 3e 80",
            "请求ID":"fc00",
            "应答ID":"fd00"
        }
    ]
}

```

#### 单体
```json
{
    "当前文件夹属性": "单体",
    "电压": {
        "ID": [
            "0x451",
            "0x452",
            "0x453",
            "0x454",
            "0x455",
            "0x456",
            "0x457",
            "0x458",
            "0x459"
        ],
        "参考": [
            "d3d4*0.001",
            "d5d6*0.001",
            "d7d8*0.001"
        ]
    }
}
```
这段配置是常见的多ID单体配置。
```json
{
    "当前文件夹属性": "单体",
    "电压": {
        "参考": [
            "d3d4*0.001",
            "d5d6*0.001",
            "d7d8*0.001"
        ],
        "0x456":{
            "帧数":23,
            "标识":[
                1
            ],
            "23":[
                "d3d4*0.001",
                "d5d6*0.001"
            ]
        }
    }
}
```
这段配置是常见的单个ID单体配置。

```json
{
    "当前文件夹属性": "单体",
    "电压": {
        "ID": [
            "0x451",
            "0x452",
            "0x453",
            "0x454",
            "0x455",
            "0x456",
            "0x457",
            "0x458",
            "0x459"
        ],
        "参考": [
            "d3d4*0.001",
            "d5d6*0.001",
            "d7d8*0.001"
        ],
        "0x451": {
            "帧数": 3,
            "标识": [
                1,
                2
            ],
            "3": [
                "d3d4*0.002",
                "d5d6*0.002"
            ]
        },
        "0x452": {
            "1": [
                "d3d4*0.002",
                "d5d6*0.002"
            ]
        }
    },
    "温度": {
        "ID": [
            "0x451",
            "0x452",
            "0x453",
            "0x454",
            "0x455",
            "0x456",
            "0x457",
            "0x458",
            "0x459"
        ],
        "参考": [
            "d3d4*0.001",
            "d5d6*0.001",
            "d7d8*0.001"
        ],
        "0x451": {
            "帧数": 3,
            "标识": [
                1,
                2
            ],
            "3": [
                "d3d4*0.002",
                "d5d6*0.002"
            ]
        },
        "0x452": {
            "1": [
                "d3d4*0.002",
                "d5d6*0.002"
            ]
        }
    }
}
```
这段是复杂的单体配置示例

#### 声明全局数据

声明全局数据的好处是数据可被重复使用。

```json
{
    "声明全局数据": [
        {
            "数据名": "默认版本信息",
            "数据属性": "版本信息",
            "引入文件": "默认版本信息.vr"
        },
        {
            "数据名": "默认读码",
            "数据属性": "读码",
            "引入文件": "默认读码.peng"
        },
        {
            "数据名": "默认清码",
            "数据属性": "清码",
            "引入文件": "默认清码.peng"
        }
    ]
}

```

全局数据的身份统一使用 **数据名** 来标记，局内文件夹可以使用数据名引用对应的数据。

#### 电子控制单元默认含有

```json
{
    "电子控制单元默认含有":[
        {"文件夹属性":"版本信息", "文件夹名称":"版本信息","引用":"默认版本信息"},
        {"文件夹属性":"读码", "文件夹名称":"读故障码","引用":"默认读码"},
        {"文件夹属性":"清码", "文件夹名称":"清故障码","引用":"默认清码"}
    ]
}
```
**电子控制单元默认含有** 的优先级是最低的，当没有其他属性的阻挠时，该属性会生效。**引用** 全局数据的数据名，将对应的数据作为该电子控制单元的数据。

#### 子文件夹不含有

```json
{
    "子文件夹不含有": [
        {
            "文件夹属性": "读码"
        },
        {
            "文件夹属性": "清码"
        }
    ]
}
```
通过指定 **子文件夹不含有** 某些文件夹，可以阻挠 **电子控制单元默认含有** 生效。

## 谢谢浏览